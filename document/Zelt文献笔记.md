# Seismic traveltime inversion for 2-D crustal velocity structure --针对二维地壳速度结构的地震走时反演

*C. A. Zelt and R. B. Smith* 
*Department of Geology and Geophysics, University of Utah, Salt Lake City, (IT USA 84112)*

[TOC]

## SUMMARY

提出了一种地震波走时反演方法，可同时确定2-D模型的**速度**和**层结构**，适用于任何类型的体波地震数据。相比于正向计算/正演（trial-and-error forward modelling），反演的好处是可以对模型参数的分辨率、精确度和多解性提供估值，并保证数据符合规定的规范。同时，解释数据所需的时间显着减少。反演方案是迭代的，并且基于：1.模型参数化；2.a method of ray tracing suited to the forward step of an inverse approach。速度值和层面节点的位置可以随着炮点-接收点的几何关系以及地下射线覆盖和近地表复杂度作自适应调整。模型参数化还允许 辅助的振幅信息 用于约束仅由走时数据所不能充分解决的模型特征。射线追踪的方法是利用：1.一种高效的基于射线追踪方程的数值解法；2.射线发射角度的自动确定；3.平滑层边界的模拟，这种边界可以产生更加稳定的反演结果。在射线追踪过程中，走时对速度和层节点深度的偏导数会被分析计算，同时使用**阻尼最小二乘法**来确定更新的参数值，该过程中速度和界面深度是**同时**确定的。停止条件和最优边界节点个数(和速度个数--每个节点定义一个速度值)是RMS/均方根走时残差和参数分辨率之间的折衷，同时也考虑到the ability to trace rays to all observations。给出了估计空间分辨率和绝对参数不确定度的方法。一个使用人为合成数据的示例表明了算法的准确性、快速收敛和对现实噪声水平的敏感性。一个针对"1986年美国内华达州IRIS-PASSCAL（大盆岭省）地震实验"的折射和广角反射走时的反演 展示了处理实际数据需要方法轮和实践考虑。我们的最终2-D速度模型与使用其他1-D和2-D正向和反向方法的研究结果进行比较，作为对反演方案的有效性的检查，并提供了导致偏差的参数不确定性，这种偏差由模型逼近和数据解释者引入。

**Key words**: inversion, model parametrization, ray tracing, seismic, traveltime, velocity.
**关键词**：反演，模型参数化，射线追踪，地震，走时，速度。

## 1. INTRODUCTION

对2-D速度结构的折射和广角反射数据的解释通常包括费力的trial-and-error ray-trace forward modelling。blabla等发表的射线追踪算法经常被使用。将理论计算结果与实际观测数据重复比较，直到构建出一个速度模型，使得理论计算值与实际观测数据相吻合。一个富有经验的解释者常常能够发现 需要调整哪个参数 来获得一个或多个炮点的同时fit。然而，前向建模终归是一个非常耗时的过程，不管计算机的速度有多快，这是由于许多迭代结果必须由人工去解释。对于单线多次放炮的地震实验，通过试错建模很难构建出一个符合可接受限度的数据模型。同时，正向建模不能提供模型参数不确定度和分辨率的定量估计或模型多解性。最后，正向建模不能确保数据在特定规范下达到最优解。

与前向建模相反，广义线性反演就能解决这些问题。对2D介质内折射和广角反射走时数据的反演方法已经被Spence (1984), Huang, Spencer & Green (1986), Firbas (1987) and Lutter, Nowack & Braile (1990)等提出，这些方法采用的射线追踪算法是最初设计用于正向建模的，这限制了这些方法的有效性，因为前向算法适合于有特殊要求的反演问题：灵活的模型参数化，其使用最少的独立参数 和计算有效且鲁棒的射线追踪方法。

本文提出了一种反向走时的技术，可以同时获得2-D速度和界面结构，其中模型参数化和射线追踪方法适用于反演算法的前进步骤(forward step)。凡是可进行正向建模的走时数据，该方法均适用，无论炮点和接收点的几何形状或数据质量如何，因为该方法中的前进步骤(forward step)等效于试错法正演模型。

走时反演的非线性特征要求我们首先建造一个初始模型，然后迭代逼近(最优解)，于是，需要一个高效的可操作的前进步骤。下面给出的模型参数化方法采用一些不同形状和大小的 blocks 来组成各个 layers，这些 blocks 使用最少的独立参数，来模拟典型的地壳和上地幔结构模型。确定每个 layer 的 参数（速度和边界节点）的数量和位置 可以是完全一般的，从而适应数据的地下分辨率，并且还允许将表面地形和近表面速度变化结合到模型中。射线方法是通过 2D射线追踪方程的高效数值解法 与 射线发射角的自动确定 相结合。通过应用**平滑层边界模拟**来减少块模型参数化带来的不稳定性。反演的第一步是对 走时对速度和节点深度的偏导数的分析计算。这些偏导数在射线跟踪过程中计算，并且可以对应于 观测走时数据中的任何一个 arrival(例如：折射、反射、首波、多次波)。走时和偏导数被插入到射线端点和实际接收位置之间，避免了**2点射线追踪**(two-point ray tracing)的必要。使用**阻尼最小二乘**反演来确定更新的模型参数(可以选择要调节哪些参数)，该过程中速度和边界节点同时考虑。

该算法适用于多炮点地壳地震资料，通常是经过前向建模之后的，因为炮点和/或接收器密度不允许应用高分辨率或波场反演技术。获得这些方法所需的预备模型通常是有用的，可以作为实验规划过程中确定最佳炮点-接收点几何形状的帮助。反演程序的效率以及 地壳地震实验中使用的典型炮点和接收点个数 使其能够在计算机工作站环境中有效运行。在描述了模型参数化和射线跟踪和反演的方法之后，使用合成数据对该程序进行了展示和测试。

## 2. MODEL PARAMETRIZATION --模型参数化

射线追踪算法及其在反演建模中的有效性最主要通过模型参数化来表征。这里提出的参数化是Zelt＆Ellis(1988)使用的版本：一个分层的，block size 可变的，2D 各向同性的速度结构。每个层边界(layer boundary)由任意数量的通过线性插值相连接的边界节点(node)来指定，每个 layer 边界节点的数量和位置可以不同。layer 边界必须从左到右贯穿模型，但各个边界不能交叉。单个节点可用于表示水平边界，而详细的地形可由多个节点指定。在每一层内，P波速度场由该层的上，下边界任意数量和间距的速度节点指定，上边界速度节点的数值和位置可能与下边界不同。每个层中的完整速度场被定义为使得 速度沿着2个节点之间的层边界线性变化 并且在垂直方向上在上下边界之间线性变化。横贯模型的层边界恒定速度由单个速度点指定，常速层由单个速度值指定。

为了进行射线追踪，每一层被横向划分成由竖直边界分开的梯形块，竖直边界由每个层边界节点或速度节点出发，于是自动地，每个小梯形快的四个顶点中至少有一个为层边界节点或速度节点。尽管速度不连续可能存在于 layer boundary 上，但在小梯形之间的竖直边界上是连续的。层边界可以通过将上层底部的速度施加到下层顶部的速度 来表示不存在速度不连续。

模型中一个小梯形的四个边界在 x-z 坐标系中的表达式分别为：

$$ x = x_1, \quad x = x_2, \quad z = s_1 x + b_1, \quad z = s_2 x + b_2 $$ 

设小梯形的四个顶点的 P 波速度分别为：$v_1,v_2,v_3,v_4$ ，那么小梯形内任意一点的 P 波速度为：

$$ v(x,z) = \frac{c_1 x + c_2 x^2 + c_3 z + c_4 x z + c_5}{c_6 x + c_7} \qquad (1) $$ 

其中，$c_i$ 为四个顶点处 P 波速度的线性叠加：

$$ \begin{equation\*}
\left\\{
\begin{aligned}
c_1 &= s_2(x_2 v_1 - x_1 v2) + b_2(v_2 - v_1) - s_1(x_2 v_3 - x_1 v_4) - b_1(v_4 - v_3) \\\\
c_2 &= s_2(v_2 - v_1) - s_1(v_4 - v_3) \\\\
c_3 &= x_1 v_2 - x_2 v_1 + x_2 v_3 - x_1 v_4 \\\\
c_4 &= v_1 - v_2 + v_4 - v_3 \\\\
c_5 &= b_2(x_2 v_1 - x_1 v_2) - b_1(x_2 v_3 - x_1 v_4) \\\\
c_6 &= (s_2 - s_1)(x_2 - x_1) \\\\
c_7 &= (b_2 - b_1)(x_2 - x_1)
\end{aligned}
\right.
\qquad (2)
\end{equation\*} $$ 

小梯形四个顶点处的速度 $v_1,v_2,v_3,v_4$ 通常是从用户输入的值线性内插得到的。

这种基于线性插值的 分层不规则小梯形网格参数化方法 具有诸多优点：(1)每个小梯形的形状及其速度场足够普通，从而只需最小数目的 block 就能表示复杂的地壳模型;(2)分层模型具有足够的“结构”，使得与射线跟踪相关的簿记相对简单有效，模型和射线组的规范更直接; (3)所有边界节点和速度点之间的线性插值确保模型是可预测的和行为良好的;(4)分层网络允许调整任何单个边界节点或速度点，并且模型保持一致和良好的定义;(5)不规则网络可以调节以适应观测数据的地下射线覆盖和分辨率。

参数化方法允许将层厚度减小到零，以便模型中可以包含尖灭和隔离体。在这种情况下，与尖灭体相邻的梯形将变成三角形，其速度场由三个顶点定义，而不是个。

## 3. RAY TRACING -- 射线追踪

射线通过速度模型追踪，利用**零阶渐近射线理论**数值求解射线追踪方程(见 Cerveng el al. 1977)。2-D 射线追踪方程是一对一阶常微分方程，可以写成两种形式:

$$ \frac{\mathrm{d}z}{\mathrm{d}x}=\cot \theta, \quad
\frac{\mathrm{d}\theta}{\mathrm{d}x}=\frac{v_z - v_x \cot \theta}{v} \qquad (3a)$$ 

或：

$$ \frac{\mathrm{d}x}{\mathrm{d}z}=\tan \theta, \quad
\frac{\mathrm{d}\theta}{\mathrm{d}z}=\frac{v_z \tan \theta - v_x}{v} \qquad (3b)$$

初始条件为：

$$ x = x_0, \quad z = z_0, \quad \theta = \theta_0 $$ 

变量 $\theta$ 是射线的切线与 $z$ 方向之间的夹角，$v$ 为射线速度，$v_x$ 和 $v_z$ 分别是 $v$ 对 $x$ 和 $z$ 的偏微分(z 向下为正)。点 $(x_0,z_0)$ 是射线的出发点，$\theta_0$ 为射线的发射角。当射线为近水平时，方程组(a)可以把 x 看作积分变量来解；当射线近竖直时，方程组(b)可以把 z 看作积分变量来解。Cervenf et al. (1977) 推荐采用带有错误控制的 Runge-Kutta 方法来解决该问题。要完成基本的射线追踪算法，还需要在射线与层边界的交叉处应用**斯奈尔定律**。

### 3.1 Ray step length --射线步长

射线步长 $\Delta$ 用于解决上述方程(a)或方程(b)，分别是 x 和 z 方向上的增量。步长在每个点上都会根据以下关系进行调节：

$$ \Delta = \frac{\alpha v}{\left| v_x \right| + \left| v_z \right|} \qquad (4) $$ 

其中 $\alpha$ 为用户指定的常数。该方程根据速度场的局部偏微分来确定步长，避免了在射线弯曲小的地方采用过小的步长 或 在射线弯曲大的地方采用过大的步长造成的潜在误差。

在具有恒定速度梯度的梯形内，射线路径是圆弧；方程式(4)确保任何射线路径（如果外推到这样的梯形中的整个圆周）将至少定义 $2\pi/\alpha$ 个步长。已知方程(1)给出的速度值，以及速度的偏微分是位置的解析函数，再加上方程(4)给出的步长，那么方程(3a)或(3b)可以有效地求解。典型的 $\alpha$ 值在 0.025-0.1 之间，可以使得典型地壳模型的总走时误差小于 ±0.002-0.01s 。在速度恒定的小梯形内，射线路径为直线。

一条穿过模型的射线由射线上的一系列点定义，这些点的数量和间距依赖于 $\alpha$ 值。射线终点代表的走时即为沿着射线路径的数值积分。

### 3.2 Ray take-off angles --射线发射角 

快速前向建模是通过 确定特定射线组的发射角 实现的，这种确定方法基于 Zelt & Ellis (1988) 描述的“迭代 发射/平分 技术”(搜索模式)。射线组(ray group)的定义是：具有相同的折射行为 或 反射点位于同一层或多层 的一组射线。对于折射射线组，在某个特定 layer 中，最浅发射角和最深发射角的两条折射射线(分别擦过该层上边界和下边界)通过迭代搜索模式确定，那么整个射线组所包含的不同射线的发射角在二者之间。对于反射射线组，在某个特定 layer 中，先找出擦过该层下边界的射线的发射角(同样通过迭代搜索模式确定)，那么该射线组的所有不同射线的发射角均大于该角度，并小于 90°。对于首波射线组，射线相交然后并入某个特定层面，其发射角即为临界角(指定允差内)，射线组沿着该层边界向前滑行并不断以临界角向上分出射线，构成了整个射线组。搜索模式所使用的初始发射角通过分析计算得到，其前提条件是假设炮点之下是一个横向均匀的模型。迭代搜索模式中追踪的射线数量取决于速度模型（即速度梯度和横向变化量）。通常，只需要不超过 20 条射线来确定一个特定的发射角，然而超过 100 条射线也并不罕见。通过广泛的实验，已经发现搜索模式对于具有大的横向速度变化的复杂模型也很有效。如果有必要，发射角可以由用户自己提供。

为了获得多次波和/或自由表面反射，折射，反射和首波射线组可以通过简单的数字代码表示，数字码包含任何层边界处的反射点的数目或组合。

迭代搜索模式基于确定射线组的最小和最大发射角，而不是像两点射线追踪(two-point ray tracing)那样将射线追踪到特定的接收器位置。因此，某个特定接收器对应的走时（以及在反演中使用的偏导数）通过包围该接收点的两个最近的射线端点之间的线性插值来确定。因此，有必要将模型稍微超出接收器阵列的边缘，以确保所有接收器都可以被两侧的射线包围。随着模型中横向速度变化的增大，有必要在每个射线组中追踪更多的射线，以获得足够精确的内插走时。将采用这种确定射线发射角的方法，因为它比两点射线追踪方法更鲁棒，计算量更少。

### 3.3 Smooth layer boundary simulation --平滑层边界模拟

*注：分块模型参数化使得模型的层边界为折线，这里需要把折线变为光滑曲线*

分块模型参数化，即具有速度或速度梯度不连续 的模型，当应用于无限频率射线传播时，具有散射和聚焦射线路径的趋势，经常在模型表面产生几何影区。这种效果不是我们所期望的，因为它不是我们所要模拟的波的传播特征。一种平滑层边界的有效模拟可以被应用到以下的层边界上：该边界由相连的多个线性线段组成，并在许多点进行了均匀采样，通常为几百个，并通过应用三点平均滤波器进行了平滑。射线追踪不受平滑层边界模拟的影响，除了使用平滑边界的坡度确定层边界处的入射角和出射角。当未平滑的层边界存在拐角时(例如2个 block 的交界处)，这种平滑模拟可以对射线轨迹产生显著影响。

为了增加这种平滑模拟的整体准确度，可以在原始层界面坡度变化较大的地方细分成更小更多的线性段。由模型“分块”引起的射线散射和聚焦以及几何影区将会减少，并且走时曲线将随着边界平滑的量变得平滑。平滑层边界模拟所需的额外 CPU 时间小于 10％。对于边界具有较大横向变化的模型，平滑层边界模拟会产生更稳定的反演结果，因为它减少或去除了几何影区并延长了走时分支(x-t 图中的曲线)，以便用到更多的观测数据。

## 4. INVERSION --反演

对于连续速度场 $v(x,z)$ ，沿着射线路径 L 的源和接收器之间的走时 t 以路径积分的形式给出：

$$ t = \int_{L}^{} \frac{1}{v(x,z)} \mathrm{d}l \qquad (5) $$ 

其离散形式：

$$ t = \sum_{i=1}^{n} \frac{l_i}{v_i} $$ 

用于实际计算中，其中 $l_i$ 和 $v_i$ 分别代表射线轨迹的第 i 个小段的长度和速度。因此，走时是速度倒数的线性加和，但是走时反演却是非线性问题，因为射线路径也是依赖于速度的。通过使用关于起始模型的泰勒级数展开线性化 并 降低高阶项来解决问题。由于使用这种展开，起始模型 和 迭代方法 是必要的。

忽略高阶项之后的线性化方程为：

$$ A \Delta m = \Delta t \qquad (6)$$ 

其中，A 为偏微分矩阵，$\Delta m$ 为模型参数调整向量，$\Delta t$ 是走时残差向量。偏微分矩阵中包含的元素为 $\partial t_i / \partial m_j$ ，其中，$t_i$ 为第 i 个观测走时，$m_j$ 为要反演的第 j 个模型参数，要么是一个速度值，要么是某个层边界的 z 坐标。 在某次迭代中射线通过模型时，走时残差向量与偏微分矩阵均会被计算。偏微分通过解析方法计算，因此，不需要追踪额外的射线来通过差分方法数值逼近微分。完成射线追踪后，方程(6)中的参数调整向量被解出，再作用于当前模型参数以更新模型，然后在更新后的模型上再次进行射线追踪。这一过程不断重复，直到模拟结果与观测数据一致到令人满意的程度，或者达到预先设定的停止条件。这些就是反演算法的基本步骤，这种方式最先被 Spence, Clowes & Ellis 应用到地壳地震数据的走时反演。

### 4.1 Partial derivatives --偏微分 

偏微分矩阵 $A$ 的大小为 $M \times N$ ，其中 $M$ 为数据的个数，$N$ 为模型参数的个数。偏微分方程中的元素是在射线追踪过程中解析计算出的，计算过程中速度和层边界节点同时考虑。从方程 (5) 可以得到：

$$ \frac{\partial t}{\partial v_j} = \int_{}^{L} - \frac{1}{v^2} \frac{\partial v}{\partial v_j} \mathrm{d}l $$ 

其中，$v_j$ 是要反演的第 $j$ 个速度值($v_1,v_2,v_3,v_4$ 中的一个)。积分内的偏微分 $\frac{\partial v}{\partial v_j}$ 可以借助方程 (1) 和 (2) 很容易地计算。一些相关的参数，比如方程 (2) 中的参数，已经在进行射线追踪之前预先计算好了。与边界节点相关的偏导数通过简单的几何考虑得到，由 Spence(1984) 首次提出。它们的微分在附录中提供以纠正错误并引入 稳定性所必需的 修改。

### 4.2 Calculating traveltimes and partial derivatives at observed receiver locations --在实际观测接收点处计算走时及其偏微分

每个要反转的走时拾取 由代表到达震相的数字代码 来标识（即特定层中的折射或反射）。正确的震相识别是地震学家最重要的一步，因为震相识别错误将导致最终模型中出现不可预测的潜在的严重错误。因此，不明显的，靠后的震相不应该参与反演，除非它们能够通过试错法正向建模来明确识别。

每个追踪的射线组必须被识别为相同的数字码，以便将计算走时与对应的观测走时进行比较。每个射线组追踪完成之后，通过两个最接近的射线端点的线性插值 来确定某个实际接收器位置处的计算走时及其偏微分。如果实际观测接收器位置被一个射线组内的多对射线端点（例如三对）包围，则最终取的 计算走时及其偏微分 是内插走时最小的一个。例如，如果模型具有多个连续的层，它们之间没有或只有很小的速度不连续性，那么多个折射射线组可能被分配相同的数字码，在这种情况下，通常不可能预先知道到达的折射射线是从哪个层边界上反射上来的。观测走时分支不会以均匀接收间隔重新采样，因为这可能导致模型特定区域的分辨率产生人为增加或降低。

### 4.3 Damped least-squares inversion --阻尼最小二乘法反演

反演问题一般是多因素决定的，所以方程 (6) 采用一种 阻尼最小二乘法 技术求解(Aki & Richards 1980)。这里用到的方法与 Lutter et al. (1990) 描述的相似，因此，这里只做一个简短的摘要和相关的计算方法以及不确定性。阻尼最小二乘法对方程 (6) 的解法可以表述如下：

$$ \Delta m = (A^T C_t^{-1} + D C_m^{-1})^{-1} A^T C_t^{-1} \Delta t \qquad (7)$$ 

其中 $C_t$ 和 $C_m$ 分别为 估计数据 和 模型协方差矩阵，分别由以下两式定义：

$$ C_t = \mathrm{diag} \left\\{ \sigma_i^2 \right\\}, \quad C_m = \mathrm{diag} \left\\{ \sigma_j^2 \right\\} $$ 

$D$ 为整体阻尼参数，一般等于 1 (Menke 1984)。

标准差 $\sigma_i$ 是第 i 个走时测量的估计不确定度。值 $\sigma_j$ 是第 j 个模型参数的一个先验的估计不确定度。对方程 (7) 的一个特殊解是，将所有的速度赋值为一个常量 $\sigma_j(\sigma_v)$ ，一般等于 0.1km/s，将所有层边界节点的 z 坐标赋值为一个常量 $\sigma_j(\sigma_z)$ ，一般为 0.1-1.0km。$\sigma_v$ 与 $\sigma_z$ 的相对大小决定了反演过程中，对速度和节点深度调整量的权衡。D 值决定了分辨率和模型参数的不确定度以及模型参数调节量之间的总体权衡。由于模型参数的数量一般小于观测点的数量，并且模型又是二维的，所以方程 (7) 中需要求逆/转置的矩阵相对较小且不太稀疏。所以，矩阵求逆采用了一种简单的 LU 分解方法 (Press et al. 1986)。

模型分辨率矩阵由下式给出：

$$ R = (A^T C_t^{-1} + D C_m^{-1})^{-1} A^T C_t^{-1} A \qquad (8) $$ 

分辨率矩阵的对角元素范围在零和一之间，表示真实模型对倒置模型的平均或线性依赖度。同样地，它们表示采样每个模型参数的射线的相对数量。对人工合成数据和实际数据的测试和实验表明，与分辨率矩阵的 大于 0.5 的对角元素 相关联的模型参数 通常得到很好的解决且比较可靠，尽管在少数情况下，这种对满意分辨率的人为截取是不合适的，即一个速度值被许多分布在很窄的角度范围内的射线路径约束。

后验模型协方差矩阵由下式给出：

$$ C = (I - R)C_m \qquad (9) $$ 

其中 $I$ 为单位矩阵 (Tarantola 1987)。通过提取 $C$ 的对角元素的平方根，获得该模型参数的计算标准差或不确定度。这些计算误差代表真实参数误差的下限，因为它们仅由于走时 picks 的不确定性而导致，并不能反映模型参数之间的权衡，以及其他一些可能的误差来源：(1) 震相识别错误；(2) 将 3D 结构建模成为 2D 模型；(3) 假定接收器形状为直线；(4) 使用不适当的模型参数化来表示真实的地球（即层数或速度和边界节点数）; (5) 使用 layered, large-block 参数化，其实真实的地球相当复杂。因此，计算的误差估计最好用于相对而不是绝对意义上。

### 4.4 Spatial resolution and absolute parameter uncertainty --空间分辨率和绝对参数不确定度

### 4.5 Model non-uniqueness --模型多解性

### 4.6 Reducing the number of independent model parameters --减少独立模型参数的数量

### 4.7 Stopping criteria and number of model parameters --终止条件和模型参数数量

## 5 TEST USING SYNTHETIC DATA --采用合成数据测试

## 6 APPLICATION TO THE 1986 IRISPASSCAL NEVADA DATA --使用 1986 IRISPASSCAL NEVADA 的数据

### 6.1 Upper crust --上地壳

### 6.2 Middle crust --中地壳

### 6.3 Lower crust and upper mantle --下地壳和上地幔

### 6.4 Comparison with velocity models from other studies --与其他研究中的速度模型对比

## 7 DISCUSSION --讨论

## ACKNOWLEDGMENTS --致谢

## REFERENCES --参考文献