line[45]
rayinvr需要二维各向同性介质。速度模型包括一系列的“层”和“层边界”，边界是
一条折线，其中的线段可以倾斜任意角度。层边界必须从左向右贯穿整个模型。层
厚可以为零，以便描述尖灭和地层中的孤立地体。层内的波速由该层顶面和底面上
的任意x坐标处的速度确定。这些已经定义了层边界、层顶面速度和层底面速度的
x坐标在层内和层间都是独立的。层边界处的速度可以不连续，但并非必须的。为了
方便射线追踪，整个模型被划分成不规则的梯形网格，每个小梯形的上下边都是倾
斜的，而左右两边都是竖直的。每个小梯形内的速度是由其四个角上速度确定的线
性速度域，因此在一个小梯形内部是可以存在水平和竖直方向的速度梯度的。可以
构建出光滑的层边界，只要通过边界的坡度计算出入射波和出射波的角度即可。
line[66]
模型中的波源可以出现在任何位置，波射线可以以任何方向发出。P波和S波以及多
次转换波都将考虑在内。所有的小梯形可能使用相同的泊松比。反射波、折射波和
首波都可能被追踪，其中还包含多次转换波。射线组的出射角将由程序通过迭代算
法自动计算得出。射线追踪是通过数字计算解二维介质的射线追踪方程——一个一阶
微分方程，使用龙格-库塔法。射线的步长是自适应的，在保证精度的条件下尽可
能高效。走时是通过沿着射线路径的梯形积分法则计算的。
line[83]
那些选定的用于调整的模型参数对走时的偏微分在射线追踪过程中被解析计算。这
些参数包括速度和层边界节点的竖直位置。这些走时与模型中可追踪的射线相对应。
走时相对于观察数据的残差也会被计算。走时及其偏微分被线性地插入到观察的地
震图中。偏微分及其相关的走时被输出保存并再次作为输入供DMPLSTSQR程序使用，
DMPLSTSQR通过针对线性反转问题的阻尼最小二乘法计算并更新模型参数。
line[96]
模型的参数化非常适合于折射/反射数据的反演，这时因为现实地球模型能够被最少
量的模型参数描述，例如，描述每一层的参数的数量和位置可以适用于地下射线分
布。层边界，包括表面，可能是水平的（一个参数即可描述）或者包含若干个直线
段。每一层可能含有一个恒定的速度（一个参数）或者由上下层的多个速度点确定。
当层边界两侧的速度不连续时，层边界的上下两侧可能被赋予不同的速度，或者，如
果界面上没有速度不连续的话，那么界面两侧将只赋予一个速度值。竖直方向的速度
梯度或层厚在反演期间在部分或所有层中可能是固定的，如果没有足够的射线分布
来确定独立的上下层速度或层厚。

line[115]
可执行文件：RAYINVR
输入文件：r.in（含义rayinvr.in） 包含5部分输入参数：
(1) PLTPAR namelist包含与作图（plotting）有关的参数；
(2) AXEPAR namelist包含与坐标轴（axes）有关的参数；
(3) TRAPAR namelist包含与射线追踪（tracing）有关的参数；
(4) INVPAR namelist包含与反演有关的参数；
(5) 去掉前三行（列头）之后，速度模型格式如下：
    (a) 层编号，层界面上的x坐标（km），从左到右（格式：I2, 1X, 10F7.2，
    I2代表一个2位宽的整数，1X代表一个空格（如果是nX就代表n个空格），
    10F7.2代表10个F7.2格式，F7.2代表一个浮点数，其总宽度为7，小数部分宽
    度为2，总宽度占不满的在左侧用空格补上）
    (b) z坐标（km），与(a)中x坐标一一对应（格式：3X, 10f7.2），代表该层顶界
    面的z坐标
    (c) 对于每个节点是否需要计算偏微分（格式：3X, 10I7），0-不需要、1-需要、-1-通过固定层
    厚来确定z坐标
    (d) 层编号，层界面上的x坐标，格式同(a)（与(a)不同，(a)用来描述层顶
    界面形状节点，这一层的层编号用来描述层顶界面的速度节点。注意：速度
    节点与形状节点可以定义在完全不同的位置）
    (e) 上一层的P波速度（km/s），与(d)中的x坐标一一对应，即该层顶界面的
    速度
    (f) 指定每个速度节点是否需要计算偏微分，格式同(c)
    (g)(h)(i) 格式同(d)(e)(f)，描述该层下界面的速度节点

    对于(a)-(c), (d)-(f), (g)-(i)的三层节点，要求每行最多包含10个节点，
    如果写不下，则需换行，换行时需要在(b)/(e)/(h)行的第二列写入一个字符
    1，表示这一行写不下，还有下一行。这时，(b)/(e)/(h)行的格式就由
    （3X, 10f7.2）变成了（I2, 1X, 10F7.2）

输入文件 v.in（含义：velocity.in） 包含与上述(5)中相同格式的速度模型

输入文件 f.in（含义：floating.in） 包含一些“浮动（floating）反射界面，
    这些界面内的速度是连续的，但却可以像层边界一样发生波的反射（原因：
    该界面上下的波阻抗有明显差别，但由于速度连续，那么只能是界面上密度
    的不连续造成的），文件的格式与 v.in 类似：
    (1) 浮动界面上的节点个数，（格式：I2）
    (2) 浮动界面节点的x坐标(km)，（格式：3X, n个F7.2）
    (3) 与(2)对应的z坐标，（格式：3X, n个F7.2）
    (4) 是否需要计算偏微分，（格式：3X, n个I7）
    有多少个浮动界面，(1)-(4)就重复多少次

输入文件 tx.in（含义：time&x-coordinate.in） 包含实际观察的走时-距离
    数值对，格式如下：
    (1) 包含4个数字，a.炮点的x坐标(km)；b.1或-1，如果接收点在炮点的右
    边为1，如果接收点在炮点的左侧为-1,；c.固定为0；d.固定为0（格式：
    3F10.3, I10）
    (2) 包含4个数字，a.接收器的x坐标(km)；b.对应的未矫正的走时(s)；c.
    走时采集的不确定度(s)；d.一个非零整数，用于描述到达接收点的波的类型
    ，以便与追踪的射线进行比较（推荐用两位整数来表示，第一位代表层号，
    第二位代表射线类型，1-折射、2-反射、3-首波）。（格式：3F10.3, I10）
    在(1)所对应的一个炮点下，(2)重复多次来描述每一个接收点。(1)和(2)的
    组合重复多次来描述多个炮点。文件以如下一行结束：
    (3) 0, 0, 0, -1 (format: 3F10.3, I10)

输出文件 tx.out 包含计算过的走时-距离数值对，格式与tx.in相同

输出文件 r1.out 包含一系列针对每一条追踪射线的概要信息，有炮点编号，发射
角度，范围，校正走时，定义射线的点数量（步长）。

输出文件 r2.out 包含速度模型中的每个小梯形区域的所有详细参数，一个一维等
价速度模型和射线轨迹上的每个点的概要信息。

输出文件 i.out 包含偏微分，走时残差和走时不确定度，这些参数将作为DMPLSTSQR
程序的输入参数。文件的开头包含以下信息：
    (1) 走时采集点的个数，和计算偏微分的模型参数个数。
    (2) 对于每个调用的模型参数，有一个整数确定了模型参数的类型（1代表层
    边界，2代表速度），模型参数的当前值，以及模型参数的估计不确定度。
    (3) 以矩阵形式表示的偏微分，走时残差和相应的不确定度。
    (4) 走时采集点的个数。
    (5) RMS走时残差。
    (6) 归一化卡方分布。

输出文件 p.out（含义：plot.out）包含绘图程序 RAYPLOT 所使用的所有绘图
命令。

输出文件 n.out 包含namelist参数值。

